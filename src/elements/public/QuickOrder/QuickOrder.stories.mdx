import { QuickOrder } from '/dist/elements/public/QuickOrder/QuickOrder.js';
import { ProductItem } from '/dist/elements/public/QuickOrder/ProductItem.js';
import { Meta, html,  Story, Preview  } from '@open-wc/demoing-storybook';
window.customElements.define('foxy-order-form', QuickOrder);
window.customElements.define('foxy-item', ProductItem);

<Meta
 title="Quick Order"
 parameters={{ component: 'quick-order'}}
/>

# Quick Order Form

Quick Order Form provides a straighforward way to create an e-commerce form to add products to a cart.

You simply feed your form with the products and it will take care of the rest for you.


You can use your favorite template engine to provide the products their attributes.

## Minimal setup

This component needs to be configured before use. You can easily spot a misconfigured component on the page – it will display an error message like the one below:

<Preview>
  <Story name="Default">
    {html`
      <div class="container-narrow">
        <foxy-order-form></foxy-order-form>
      </div>
    `}
  </Story>
</Preview>

You'll need to provide the following info via the respective attributes for the minimal setup:

1. `store` – store name (your subdomain, e.g the `jamstackecommerceexample` part of `https://jamstackecommerceexample.foxycart.com`);
1. `currency` – 3-letter currency code (e.g. `usd` for US dollars);
1. One or more products.  You may feed the products to the Form using either:
1. - **the `slots` approach** using the provided `<product-item></product-item>` Web Component;
   - **the `attribute` approach** using the `products` parameter;

Using the **product-item** approach gives you full control over your form's markup.
This approach allow you to create your form writing your HTML in readable way.

```html
<foxy-order-form>
  <foxy-item></foxy-item>
  <foxy-item></foxy-item>
  <foxy-item></foxy-item>
</foxy-order-form>
```
Using the **products parameter** approach is handy if you are fetching your products from a server as a JSON object.
Please, note that the `products` value must be valid JSON.
This approach allows you to use something as simple as:

```html
<foxy-order-form products='[{...},{...},{...}]'>
</foxy-order-form>
```

<Preview>
  <Story name="Minimal">
    {html`
    <div class="container-narrow">
      <foxy-order-form store="jamstackecommerceexample.foxycart.com" currency="usd">
        <foxy-item name="Cool Product" price="10"></foxy-item>
      </foxy-order-form>
    </div>
    `}
  </Story>
</Preview>


The downside of this approach is that you have little control of custom markup you may want to add to your form.

## Basics of a Product

A product must have a `name`, a `price` and a `currency`.
The currency will be automatically provided by the `<foxy-order-form>`.

The `description` attribute is used to display a description of the product within the order form.

Foxy Cart handles both basic and advanced features and many of them are accessible by setting products parameters.

Here are some of the attributes you can use:

|Attribute| Description| Example |
|---------|---------|---------|
|image|Shows a thumbnail of this image in the cart.| `<foxy-item image="http://mysite/myimage.png"></foxy-item>`|
|quantity_max|Maximum quantity that should be allowed per product, per cart.|`<foxy-item quantity_max="5"></foxy-item>`|
|weight|Product's per-product weight, used for shipping rate requests.|`<foxy-item weight="3"></foxy-item>`|
|category|Category identifier for the product.|`<foxy-item category="food"></foxy-item>`|

It pays off to learn more about the product and what you can do with it. Please, vist the [Product's parameters page](https://wiki.foxycart.com/v/2.0/products#a_complete_list_of_product_parameters) to learn more.

## Usage

### Using custom tag for the product

By adding `foxy-items` to your `foxy-order-form` your products will be properly added to the order. The form will find the products and create the propper submission.

You can use any markup you wish, making the form unique to your store and even easily adding your own functionality to it.

You may place your products in cards, lists, articles sections and even tables if you with.

Foxy-order-form will find your products and of course leave your tags alone.
You can use custom elements, but `foxy-order-form` will not find them if they are in a Shadow DOM.

<Preview>
  <Story name="Using Product Items">
    {html`
    <foxy-order-form store="jamstackecommerceexample.foxycart.com" currency="usd">
        <foxy-item name="pup dog food"
                   price="59.99"
                   image="https://www.foxy.io/merchants/shopping-cart-full.svg"
                   description="High quality nutritious food for you pet." >
        </foxy-item>
        <foxy-item name="pup dog rich food" price="69.99"
                   image="https://www.foxy.io/merchants/shopping-cart-full.svg"
                   description="Delicious food! Perfect nutrition in a easy to transport and easy to save package" >
        </foxy-item>
    </foxy-order-form>
    `}
  </Story>
</Preview>

You can enrich your form by adding your own markup.
Provided your products are not inside a Shadow DOM, they will be recognized.

<Preview>
  <Story name="Using your markup">
    {html`
    <foxy-order-form currency="usd">
      <style>
      .dietary-food {
        font-weight: 100;
        border: solid thin silver;
        border-radius: 6px;
        padding: 1em;
        columns: 2;
        margin-bottom: 1em;
        background: #fafafa;
      }
      .dietary-food img {
        height: 4em
      }
      table {
        margin: 1em;
      }
      table td {
        border: solid thin silver;
        border-collapse: collapse;
        padding: 0.5em;
      }
      section.special-items {
        padding: 1em;
        border: double #6666ff;
        background: #ededff;
        border-radius: 6px;
      }
      </style>
      <h2>diet food</h2>
      <section class="dietary-food" >
        <foxy-item name="pup dog food"
                   price="59.99"
                   image="https://www.foxy.io/merchants/shopping-cart-full.svg"
                   description="High quality nutritious food for you pet." >
        </foxy-item>
        <foxy-item name="pup dog rich food" price="69.99"
          image="https://www.foxy.io/merchants/shopping-cart-full.svg"
          description="Delicious food! Perfect nutrition in a easy to transport and easy to save package"
          >
        </foxy-item>
      </section>
      <section class="special-items">
          <h2>Special item</h2>
          <foxy-item
            name="pup dog food"
            price="69.99"
            image="https://www.foxy.io/merchants/shopping-cart-full.svg">
            <section style="display: flex">
              <p>This incredible product was developed by dedicated nutrition experts, building upon the most advanced research</p>
              <table>
                <tr><td>Easily digested</td><td>✓</td></tr>
                <tr><td>Perfectly balenced</td><td>✓</td></tr>
                <tr><td>Environmentaly responsible</td><td>✓</td></tr>
              </table>
          </foxy-item>
        </section>
      </section>
      </section>
    </foxy-order-form>
    `}
  </Story>
</Preview>


### Setting up subscriptions

To offer a subscription option to your clients you need to provide the subscription options to your clients.

You can configure subscriptions using the subscription product options, as outlined at [https://wiki.foxycart.com/v/2.0/cheat_sheet#subscription_product_options](Subscription Product Options).

<Preview>
  <Story name="Product with subscription" >
    {html`
    <foxy-order-form currency="usd"
                     frequencyOptions='["1d", "1w", ".5m", "1m"]'>
      <foxy-item name="Pup Dog Food"
                 price="69.99"
                 image="https://www.foxy.io/merchants/shopping-cart-full.svg" >
      </foxy-item>
    </foxy-order-form>
    `}
  </Story>
</Preview>

## Using an array of products

You may use an array of product objects to feed data to the form.

In this scenario you loose some flexibility for the product tags will be created for you one next to the other.

<Preview>
  <Story name="Using an Array of products">
    {html`
    <foxy-order-form
      currency="usd"
      products='[{"name":"Cub Puppy","price":"75.95"},{"name":"Bird Dog","price":"64.95"}]'
      >
    </foxy-order-form>
    `}
  </Story>
</Preview>

## Adding Child products

Child products allow you to bundle a set of products together. You can achieve this by nesting `foxy-item` custom tags.

<Preview>
  <Story name="Child Products">
    {html`
  <foxy-order-form
      currency="usd"
  >
        <h2>diet food</h2>
        <section >
          <foxy-item name="Food Pack" price="0.00" image="https://www.foxy.io/merchants/shopping-cart-full.svg">
            <foxy-item name="pup dog rich food" price="69.99" image="https://www.foxy.io/merchants/shopping-cart-full.svg" > </foxy-item>
            <foxy-item name="pup dog rich food" price="69.99" image="https://www.foxy.io/merchants/shopping-cart-full.svg"> </foxy-item>
          </foxy-item>
        </section>
    </foxy-order-form>
    `}
  </Story>
</Preview>

## Adding Child products using a product array

You can also use the `children` field of a product in the product array to add children to a product.

<Preview>
  <Story name="Child products with a JS Array">
    {html`
    <foxy-order-form
      store="jamstackecommerceexample"
      currency="usd"
      products='[
        {
          "name":"Artists Drawing Set",
          "price":"75.95",
          "children":[
            {
              "name":"Nanking Pencil",
              "price":"0"
            },
            {
              "name":"Blank Canvas",
              "price":"0"
            },
            {
              "name":"Water based paint",
              "price":"0"
            }
          ]}
        ]'>
    </foxy-order-form>
    `}
  </Story>
</Preview>


### Start and end dates

Subscription settings are defined for the form, not individual products.

Start and end dates must follow the pattern described in FoxyCart documentation:
https://wiki.foxycart.com/v/2.0/products#subscription_product_options

You may set specific dates with the format `YYYYMMDD`, or relative dates using a number with a letter (d for day, w for week, m for month and y for year) appended to it.
Check out the documentation for more details.

<Preview>
  <Story name="Start and End Dates" >
    {html`
    <foxy-order-form frequencyOptions='["1d", "1w", ".5m", "1m"]'
                    currency="usd"
                    sub_startdate="20200505"
                    sub_enddate="20210505" >
      <foxy-item
        name="Pup Dog Food"
        price="69.99"
        description="High quality nutritious food for you pet "
        sub_frequency="1m"
        >
      </foxy-item>
    </foxy-order-form>
    `}
  </Story>
</Preview>

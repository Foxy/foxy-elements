import dedent from 'dedent';
import { html } from 'lit-html';
import { unsafeHTML } from 'lit-html/directives/unsafe-html';
import {
  Subtitle,
  ArgsTable,
  Story,
  Canvas,
  Meta,
} from '@web/storybook-prebuilt/addon-docs/blocks.js';
import './index.ts';

<Meta
  title="Forms / AddressForm"
  argTypes={{
    readonlycontrols: {
      control: {
        type: 'check',
        options: [
          'address-name',
          'first-name',
          'last-name',
          'company',
          'phone',
          'address-one',
          'address-two',
          'country',
          'region',
          'city',
          'postal-code',
        ],
      },
    },
    disabledcontrols: {
      control: {
        type: 'check',
        options: [
          'address-name',
          'first-name',
          'last-name',
          'company',
          'phone',
          'address-one',
          'address-two',
          'country',
          'region',
          'city',
          'postal-code',
          'create',
          'delete',
        ],
      },
    },
    hiddencontrols: {
      control: {
        type: 'check',
        options: [
          'address-name',
          'first-name',
          'last-name',
          'company',
          'phone',
          'address-one',
          'address-two',
          'country',
          'region',
          'city',
          'postal-code',
          'timestamps',
          'create',
          'delete',
        ],
      },
    },
    lang: {
      control: {
        type: 'select',
        options: ['en', 'es'],
      },
    },
  }}
/>

# AddressForm

<Subtitle>Basic form displaying customer address</Subtitle>

<Canvas
  mdxSource={dedent`
    <foxy-address-form
      parent="https://demo.foxycart.com/s/admin/customers/0/customer_addresses"
      href="https://demo.foxycart.com/s/admin/customer_addresses/0"
    >
    </foxy-address-form>
  `}
  isExpanded
>
  <Story
    name="Playground"
    args={{
      readonlycontrols: [],
      disabledcontrols: [],
      hiddencontrols: [],
      readonly: false,
      disabled: false,
      lang: 'en',
      href: 'https://demo.foxycart.com/s/admin/customer_addresses/0',
      parent: 'https://demo.foxycart.com/s/admin/customers/0/customer_addresses',
      'address-name:before': '',
      'address-name:after': '',
      'first-name:before': '',
      'first-name:after': '',
      'last-name:before': '',
      'last-name:after': '',
      'company:before': '',
      'company:after': '',
      'phone:before': '',
      'phone:after': '',
      'address-one:before': '',
      'address-one:after': '',
      'address-two:before': '',
      'address-two:after': '',
      'country:before': '',
      'country:after': '',
      'region:before': '',
      'region:after': '',
      'city:before': '',
      'city:after': '',
      'postal-code:before': '',
      'postal-code:after': '',
      'timestamps:before': '',
      'timestamps:after': '',
      'create:before': '',
      'create:after': '',
      'delete:before': '',
      'delete:after': '',
    }}
  >
    {args =>
      html`
        <foxy-address-form
          disabledcontrols=${args.disabledcontrols.join(' ')}
          readonlycontrols=${args.readonlycontrols.join(' ')}
          hiddencontrols=${args.hiddencontrols.join(' ')}
          ?disabled=${args.disabled}
          ?readonly=${args.readonly}
          parent=${args.parent}
          class="container-narrow"
          href=${args.href}
          lang=${args.lang}
        >
          <div slot="first-name:before">${unsafeHTML(args['first-name:before'])}</div>
          <div slot="first-name:after">${unsafeHTML(args['first-name:after'])}</div>
          <div slot="last-name:before">${unsafeHTML(args['last-name:before'])}</div>
          <div slot="last-name:after">${unsafeHTML(args['last-name:after'])}</div>
          <div slot="company:before">${unsafeHTML(args['company:before'])}</div>
          <div slot="company:after">${unsafeHTML(args['company:after'])}</div>
          <div slot="phone:before">${unsafeHTML(args['phone:before'])}</div>
          <div slot="phone:after">${unsafeHTML(args['phone:after'])}</div>
          <div slot="address-one:before">${unsafeHTML(args['address-one:before'])}</div>
          <div slot="address-one:after">${unsafeHTML(args['address-one:after'])}</div>
          <div slot="address-two:before">${unsafeHTML(args['address-two:before'])}</div>
          <div slot="address-two:after">${unsafeHTML(args['address-two:after'])}</div>
          <div slot="country:before">${unsafeHTML(args['country:before'])}</div>
          <div slot="country:after">${unsafeHTML(args['country:after'])}</div>
          <div slot="region:before">${unsafeHTML(args['region:before'])}</div>
          <div slot="region:after">${unsafeHTML(args['region:after'])}</div>
          <div slot="city:before">${unsafeHTML(args['city:before'])}</div>
          <div slot="city:after">${unsafeHTML(args['city:after'])}</div>
          <div slot="postal-code:before">${unsafeHTML(args['postal-code:before'])}</div>
          <div slot="postal-code:after">${unsafeHTML(args['postal-code:after'])}</div>
          <div slot="timestamps:before">${unsafeHTML(args['timestamps:before'])}</div>
          <div slot="timestamps:after">${unsafeHTML(args['timestamps:after'])}</div>
          <div slot="create:before">${unsafeHTML(args['create:before'])}</div>
          <div slot="create:after">${unsafeHTML(args['create:after'])}</div>
          <div slot="delete:before">${unsafeHTML(args['delete:before'])}</div>
          <div slot="delete:after">${unsafeHTML(args['delete:after'])}</div>
        </foxy-address-form>
      `
    }
  </Story>
</Canvas>

## Reference

<ArgsTable of="foxy-address-form" />

### hAPI

This element supports the following resources: [customer_address](https://api.foxycart.com/rels/customer_address), [default_billing_address](https://api.foxycart.com/rels/default_billing_address), [default_shipping_address](https://api.foxycart.com/rels/default_shipping_address).

### i18next

This element supports the following namespaces: `address-form`, `country`, `region`, `shared`.

### Theming

Our elements are built with Vaadin Lumo theme and therefore share the list of CSS Custom Properties with it. You can find the latest documentation and theme editor on [demo.vaadin.com](https://demo.vaadin.com/lumo-editor/).

<Story name="State: idle.template.clean.invalid" parameters={{ docs: { disable: true } }}>
  {() =>
    html`
      <foxy-address-form
        parent="https://demo.foxycart.com/s/admin/customers/0/customer_addresses"
        class="container-narrow"
      >
      </foxy-address-form>
    `
  }
</Story>

<Story name="State: idle.template.dirty.valid" parameters={{ docs: { disable: true } }}>
  {() => html`
    <foxy-address-form
      parent="https://demo.foxycart.com/s/admin/customers/0/customer_addresses"
      class="container-narrow"
      @update=${((isUpdating = false) => evt => {
        if (!isUpdating && !evt.target.in({ idle: { template: { dirty: 'valid' } } })) {
          isUpdating = true;
          evt.target.data = null;
          evt.target.edit({ address1: '12345 Any Street', address_name: 'Test' });
          evt.target.updateComplete.then(() => (isUpdating = false));
        }
      })()}
    >
    </foxy-address-form>
  `}
</Story>

<Story name="State: idle.snapshot" parameters={{ docs: { disable: true } }}>
  {() =>
    html`
      <foxy-address-form
        parent="https://demo.foxycart.com/s/admin/customers/0/customer_addresses"
        href="https://demo.foxycart.com/s/admin/customer_addresses/0"
        class="container-narrow"
      >
      </foxy-address-form>
    `
  }
</Story>

<Story name="State: busy" parameters={{ docs: { disable: true } }}>
  {() =>
    html`
      <foxy-address-form
        parent="https://demo.foxycart.com/s/admin/customers/0/customer_addresses"
        href="https://demo.foxycart.com/s/admin/sleep"
        class="container-narrow"
      >
      </foxy-address-form>
    `
  }
</Story>

<Story name="State: fail" parameters={{ docs: { disable: true } }}>
  {() =>
    html`
      <foxy-address-form
        parent="https://demo.foxycart.com/s/admin/customers/0/customer_addresses"
        href="https://demo.foxycart.com/s/admin/not-found"
        class="container-narrow"
      >
      </foxy-address-form>
    `
  }
</Story>

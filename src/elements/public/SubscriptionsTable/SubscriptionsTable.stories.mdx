import { html } from 'lit-html';
import { Story, Canvas, Meta } from '@storybook/addon-docs/blocks';
import { subscriptions } from '../../../mocks/FxSubscriptions';
import { items } from '../../../mocks/FxItems';
import './index.ts';

<Meta title="Tables / Subscriptions" component="foxy-subscriptions-table" />

# Subscriptions

[![hAPI](https://img.shields.io/badge/hAPI-subscriptions-green.svg)](https://api.foxycart.com/rels/subscriptions)

## States

Below are all the states this component can render.

### Loading

Displayed while loading the resource.

export function handleRequestWithLoading(evt) {
  evt.detail.handle(() => new Promise(() => {}));
}

<Canvas>
  <Story name="Loading">
    {() =>
      html`
        <foxy-subscriptions-table
          href="https://api.foxy.test/stores/8/subscriptions?customer_id=115&limit=10"
          @request=${handleRequestWithLoading}
        >
        </foxy-subscriptions-table>
      `
    }
  </Story>
</Canvas>

### Error

Displayed when resource load fails.

export function handleRequestWithError(evt) {
  evt.detail.handle(() => Promise.reject());
}

<Canvas>
  <Story name="Error">
    {() =>
      html`
        <foxy-subscriptions-table
          href="https://api.foxy.test/stores/8/subscriptions?customer_id=115&limit=10"
          @request=${handleRequestWithError}
        >
        </foxy-subscriptions-table>
      `
    }
  </Story>
</Canvas>

### Ready

Displayed after the resource is loaded.

export function handleRequestWithSuccess(evt) {
  evt.detail.handle(async url => {
    if (url.startsWith('https://api.foxy.test/transactions/3820290/items')) {
      return new Response(JSON.stringify(items));
    } else {
      return new Response(JSON.stringify(subscriptions));
    }
  });
}

<Canvas>
  <Story name="Ready">
    {() =>
      html`
        <foxy-subscriptions-table
          href="https://api.foxy.test/stores/8/subscriptions?customer_id=115&limit=10"
          @request=${handleRequestWithSuccess}
        >
        </foxy-subscriptions-table>
      `
    }
  </Story>
</Canvas>

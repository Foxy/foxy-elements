import { html } from 'lit-html';
import { Story, Canvas, Meta } from '@storybook/addon-docs/blocks';
import { customers } from '../../../mocks/FxCustomers';
import './index.ts';

export const handleRequest = evt => {
  evt.detail.handle(async url => {
    await new Promise(resolve => setTimeout(resolve, 500));
    //
    if (url.startsWith('https://api.foxy.test/stores/8/customers')) {
      return new Response(JSON.stringify(customers));
    }
    //
    return new Response(null, { status: 404 });
  });
};

<Meta title="Relations/Customers" component="foxy-customers" />

# Customers

[![hAPI](https://img.shields.io/badge/hAPI-customers-green.svg)](https://api.foxycart.com/rels/customers)

The `<foxy-customers>` element is a **relation element** that provides a visual interface for interacting with the `customers` hAPI relation.

## Setup

All relation elements need an `href` attribute to know where to load their content from and a request handler to connect to the backend. You can check if your component is configured properly by running your project and looking for the error message like below â€“ if it isn't there, then you're good to go.

<Canvas>
  <Story name="Default" height="320px">
    {() =>
      html`
        <div class="container mx-auto p-2 sm:p-4 md:p-6 lg:p-8">
          <foxy-customers></foxy-customers>
        </div>
      `
    }
  </Story>
</Canvas>

<Canvas height="320px">
  <Story name="Configured">
    {() =>
      html`
        <div class="container mx-auto p-2 sm:p-4 md:p-6 lg:p-8">
          <foxy-customers href="https://api.foxy.test/stores/8/customers" @request=${handleRequest}>
          </foxy-customers>
        </div>
      `
    }
  </Story>
</Canvas>
